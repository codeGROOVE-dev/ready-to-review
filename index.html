<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A modern dashboard for managing GitHub pull requests">
    <title>Ready To Review - GitHub PR Dashboard</title>
    <link rel="stylesheet" href="/assets/styles.css">
    <link rel="icon" href="/favicon.ico">
    <link rel="preconnect" href="https://api.github.com">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="container">
                <div class="header-content">
                    <div class="header-left">
                        <button id="hamburgerMenu" class="hamburger-menu" aria-label="Menu" aria-expanded="false">
                            <span class="hamburger-line"></span>
                            <span class="hamburger-line"></span>
                            <span class="hamburger-line"></span>
                        </button>
                        <h1 class="header-title">ðŸš€ Ready To Review <span style="font-size: 11px; color: #dc2626; font-weight: 500; vertical-align: super; margin-left: 2px;">beta</span></h1>
                        <div class="controls">
                            <select id="orgSelect" class="org-select" aria-label="Filter by organization">
                                <option value="">All Organizations</option>
                            </select>
                            <input type="search" id="searchInput" class="search-input" placeholder="Search PRs..." aria-label="Search pull requests">
                        </div>
                    </div>
                    <div class="header-right">
                        <div id="userInfo" class="user-info">
                            <button id="loginBtn" class="btn btn-primary">Login with GitHub</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Slide-out Menu -->
        <aside id="slideMenu" class="slide-menu">
            <div class="slide-menu-header">
                <h2 class="slide-menu-title">Menu</h2>
                <button id="closeMenu" class="close-menu" aria-label="Close menu">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <nav class="slide-menu-nav">
                <a href="#" id="dashboardLink" class="menu-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7" rx="1"/>
                        <rect x="14" y="3" width="7" height="7" rx="1"/>
                        <rect x="3" y="14" width="7" height="7" rx="1"/>
                        <rect x="14" y="14" width="7" height="7" rx="1"/>
                    </svg>
                    Dashboard
                </a>
                <a href="#" id="statsLink" class="menu-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 20V10M6 20V4m12 16v-6"/>
                        <rect x="3" y="20" width="18" height="1" fill="currentColor"/>
                    </svg>
                    Stats
                </a>
                <a href="#" id="notificationsLink" class="menu-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10 5a2 2 0 114 0 7 7 0 014 6v3a4 4 0 01-2 3H8a4 4 0 01-2-3v-3a7 7 0 014-6zM9 21h6"/>
                    </svg>
                    Notifications
                </a>
                <a href="#" id="settingsLink" class="menu-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m20.5-6.5L17 9l-4.5-4.5M20.5 17.5L17 14l-4.5 4.5M3.5 6.5L8 11l4.5-4.5M3.5 17.5L8 14l4.5 4.5"/>
                    </svg>
                    Robot Army
                </a>
            </nav>
        </aside>
        
        <!-- Menu Backdrop -->
        <div id="menuBackdrop" class="menu-backdrop"></div>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Login Prompt -->
                <div id="loginPrompt" class="login-prompt" hidden>
                    <div class="card login-card">
                        <svg class="login-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
                        </svg>
                        <h2>Welcome to Ready To Review</h2>
                        <p>Choose how you'd like to access your GitHub pull requests</p>
                        
                        <div class="login-options">
                            <a href="?demo=true" class="btn btn-secondary btn-large">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                                    <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Try Demo Mode
                            </a>
                            
                            <button class="btn btn-primary btn-large" onclick="window.App.showGitHubAppModal()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
                                </svg>
                                Login with GitHub App
                            </button>
                            
                            <button class="btn btn-outline btn-large" onclick="window.App.initiatePATLogin()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/>
                                    <line x1="8" y1="12" x2="16" y2="12"/>
                                </svg>
                                Use Personal Access Token
                            </button>
                        </div>
                        
                        <div style="margin-top: 1rem; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; font-size: 0.8125rem; color: #475569;">
                            <strong>Note:</strong> GitHub OAuth Apps may not show all PRs in your repositories, particularly those created by bots (like Dependabot). For complete access, use a Personal Access Token.
                        </div>
                    </div>
                </div>
                
                <!-- GitHub App Installation Modal -->
                <div id="githubAppModal" class="modal" hidden>
                    <div class="modal-backdrop" onclick="window.App.closeGitHubAppModal()"></div>
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Install Ready to Review GitHub App</h3>
                            <button class="modal-close" onclick="window.App.closeGitHubAppModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <p>To use the GitHub App authentication, you need to first install the Ready to Review app on your GitHub account or organization.</p>
                            <ol>
                                <li>Visit <a href="https://github.com/apps/ready-to-review-beta" target="_blank" rel="noopener">Ready to Review Beta GitHub App</a></li>
                                <li>Click "Install" or "Configure" to add it to your repositories</li>
                                <li>Select the repositories you want to access</li>
                                <li>Complete the installation</li>
                                <li>Come back here and click "Continue with Authentication"</li>
                            </ol>
                            <div style="margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: flex-end;">
                                <button class="btn btn-secondary" onclick="window.App.closeGitHubAppModal()">Cancel</button>
                                <button class="btn btn-primary" onclick="window.App.proceedWithOAuth()">Continue with Authentication</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PAT Instructions Modal -->
                <div id="patModal" class="modal" hidden>
                    <div class="modal-backdrop" onclick="window.App.closePATModal()"></div>
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Create a GitHub Personal Access Token</h3>
                            <button class="modal-close" onclick="window.App.closePATModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <p><strong>Quick method:</strong> If you have the GitHub CLI installed, run:</p>
                            <pre style="background: #f3f4f6; padding: 0.75rem; border-radius: 0.375rem; margin: 1rem 0;"><code>gh auth token</code></pre>
                            <p>Then paste the token below.</p>
                            
                            <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #e5e7eb;">
                            
                            <p><strong>Alternative:</strong> Visit <a href="https://github.com/settings/personal-access-tokens" target="_blank" rel="noopener">GitHub Personal Access Tokens</a> to create a longer-lived token with these permissions:</p>
                            <ul style="margin: 0.5rem 0 1rem 1.5rem;">
                                <li><strong>Pull requests:</strong> Read-only</li>
                            </ul>
                            
                            <div class="pat-input-group">
                                <input type="password" id="patInput" class="pat-input" placeholder="Paste your token here">
                                <button class="btn btn-primary" onclick="window.App.submitPAT()">Save Token</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PR Sections -->
                <div id="prSections" class="pr-sections" hidden>
                    <!-- Incoming PRs -->
                    <section class="pr-section">
                        <header class="section-header">
                            <div class="section-title">
                                <svg class="section-icon icon-incoming" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
                                </svg>
                                <h2>Incoming</h2>
                                <span id="incomingCount" class="count">0</span>
                                <label class="filter-checkbox">
                                    <input type="checkbox" id="incomingFilterStale" checked>
                                    <span>Include stale</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" id="incomingFilterBlockedOthers">
                                    <span>Include blocked on others</span>
                                </label>
                            </div>
                            <div class="section-stats">
                                <span id="incomingAverage" class="stat-text"></span>
                            </div>
                        </header>
                        <div id="incomingPRs" class="pr-list"></div>
                    </section>

                    <!-- Outgoing PRs -->
                    <section class="pr-section">
                        <header class="section-header">
                            <div class="section-title">
                                <svg class="section-icon icon-outgoing" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M5 10l7-7m0 0l7 7m-7-7v18"/>
                                </svg>
                                <h2>Outgoing</h2>
                                <span id="outgoingCount" class="count">0</span>
                                <label class="filter-checkbox">
                                    <input type="checkbox" id="outgoingFilterStale" checked>
                                    <span>Include stale</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" id="outgoingFilterBlockedOthers" checked>
                                    <span>Include blocked on others</span>
                                </label>
                            </div>
                            <div class="section-stats">
                                <span id="outgoingAverage" class="stat-text"></span>
                            </div>
                        </header>
                        <div id="outgoingPRs" class="pr-list"></div>
                    </section>

                    <!-- Empty State -->
                    <div id="emptyState" class="empty-state" hidden>
                        <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 01-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 01.53-.88 10 10 0 019.94 0A1 1 0 0115 6v7"/>
                            <circle cx="12" cy="12" r="1"/>
                        </svg>
                        <p>No pull requests found</p>
                        <p class="text-secondary">Pull requests will appear here when they're ready for review</p>
                    </div>
                </div>
                
                <!-- Stats Page -->
                <div id="statsPage" class="stats-page" hidden>
                    <header class="stats-header">
                        <h1 class="stats-title">Pull Request Statistics</h1>
                        <p class="stats-subtitle">10-day activity by organization</p>
                    </header>
                    
                    <div id="orgStatsContainer" class="org-stats-container">
                        <!-- Organization sections will be dynamically added here -->
                    </div>
                </div>
                
                <!-- Notifications Page -->
                <div id="notificationsPage" class="notifications-page" hidden>
                    <header class="notifications-header">
                        <h1 class="notifications-title">ðŸ”” Notification Settings</h1>
                        <p class="notifications-subtitle">Configure how you receive pull request notifications</p>
                    </header>
                    
                    <div class="notifications-content">
                        <!-- Desktop App Section -->
                        <div class="desktop-app-section card">
                            <div class="desktop-app-header">
                                <svg class="desktop-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                                    <line x1="8" y1="21" x2="16" y2="21"/>
                                    <line x1="12" y1="17" x2="12" y2="21"/>
                                </svg>
                                <div>
                                    <h2>Desktop Notifications</h2>
                                    <p>Get real-time notifications on your desktop with our menu bar app</p>
                                </div>
                            </div>
                            <div class="desktop-app-info">
                                <p>The Ready to Review desktop app provides instant notifications when pull requests need your attention.</p>
                                <ul class="feature-list">
                                    <li>âœ“ Native desktop notifications</li>
                                    <li>âœ“ Menu bar quick access</li>
                                    <li>âœ“ Real-time updates</li>
                                    <li>âœ“ Works across all your organizations</li>
                                </ul>
                                <a href="https://github.com/ready-to-review/pr-menubar" target="_blank" rel="noopener" class="btn btn-primary">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                                        <polyline points="7 10 12 15 17 10"/>
                                        <line x1="12" y1="15" x2="12" y2="3"/>
                                    </svg>
                                    Download Desktop App
                                </a>
                                <span class="badge-beta">BETA</span>
                            </div>
                        </div>
                        
                        <!-- Slack Integration Section -->
                        <div class="slack-section card">
                            <div class="slack-header">
                                <svg class="slack-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14.5 10c-.83 0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/>
                                    <path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
                                    <path d="M9.5 14c.83 0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/>
                                    <path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/>
                                    <path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83 0-1.5-.67-1.5-1.5z"/>
                                    <path d="M14 20.5V19h1.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5z"/>
                                    <path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83 0 1.5-.67 1.5-1.5z"/>
                                    <path d="M10 3.5V5H8.5C7.67 5 7 4.33 7 3.5S7.67 2 8.5 2s1.5.67 1.5 1.5z"/>
                                </svg>
                                <div>
                                    <h2>Slack Notifications</h2>
                                    <p>Configure Slack bots to send notifications to channels or direct messages</p>
                                </div>
                            </div>
                            
                            <div class="slack-info">
                                <p>To configure Slack notifications, you'll need to set up the following bots in your Robot Army settings:</p>
                                
                                <div class="slack-bot-cards">
                                    <div class="slack-bot-card">
                                        <h3>SlackChan 4000</h3>
                                        <p>Sends code review requests to specific Slack channels</p>
                                        <ul class="config-list">
                                            <li>Configure channel mappings</li>
                                            <li>Set notification preferences</li>
                                            <li>Customize message templates</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="slack-bot-card">
                                        <h3>SlackDM 4001</h3>
                                        <p>Sends direct messages to PR assignees on Slack</p>
                                        <ul class="config-list">
                                            <li>Map GitHub users to Slack users</li>
                                            <li>Personalized notifications</li>
                                            <li>Urgency-based messaging</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <p class="slack-note">Note: Slack integration requires configuration in the Robot Army settings. You'll need to provide Slack API tokens and configure channel/user mappings.</p>
                                
                                <button id="goToRobotArmy" class="btn btn-secondary">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="3"/>
                                        <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m20.5-6.5L17 9l-4.5-4.5M20.5 17.5L17 14l-4.5 4.5M3.5 6.5L8 11l4.5-4.5M3.5 17.5L8 14l4.5 4.5"/>
                                    </svg>
                                    Configure in Robot Army
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Page -->
                <div id="settingsPage" class="settings-page" hidden>
                    <header class="settings-header">
                        <h1 class="settings-title">ðŸ¤– Robot Army Configuration</h1>
                        <p class="settings-subtitle">Configure automated workflows for your repositories</p>
                    </header>
                    
                    <div class="settings-content">
                        <!-- Organization Selection -->
                        <div class="org-selection card">
                            <h2>Select Organization</h2>
                            <p>Choose an organization where you've been active in the last 30 days</p>
                            <select id="orgSelectSettings" class="org-select-settings">
                                <option value="">Loading organizations...</option>
                            </select>
                        </div>
                        
                        <!-- Robot Configuration -->
                        <div id="robotConfig" class="robot-config" hidden>
                            <div class="robot-army-header">
                                <img src="/assets/army.png" alt="Robot Army" class="robot-army-image">
                                <div class="robot-army-content">
                                    <h2 class="robot-section-title">Configure your robot army</h2>
                                    <p class="robot-army-description">
                                        An army of GitHub bots ready to replace human toil with battle-tested automation, 
                                        with an aim of improving developer velocity and improving their flow state.
                                    </p>
                                </div>
                            </div>
                            
                            <!-- Robot cards will be dynamically added here -->
                            <div id="robotCards" class="robot-cards">
                            </div>
                            
                            <!-- Export Section -->
                            <div class="export-section">
                                <button id="exportConfig" class="btn btn-primary btn-large">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                                        <polyline points="7 10 12 15 17 10"/>
                                        <line x1="12" y1="15" x2="12" y2="3"/>
                                    </svg>
                                    Export Configuration
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- YAML Export Modal -->
                    <div id="yamlModal" class="modal" hidden>
                        <div class="modal-backdrop" onclick="window.App.closeYamlModal()"></div>
                        <div class="modal-content modal-large">
                            <div class="modal-header">
                                <h3>Export Robot Configuration</h3>
                                <button class="modal-close" onclick="window.App.closeYamlModal()">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p>Copy the configuration below and commit it to:</p>
                                <code class="yaml-path" id="yamlPathModal"></code>
                                <pre id="yamlContent" class="yaml-content"></pre>
                                <button id="copyYaml" class="btn btn-primary" onclick="window.App.copyYaml()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                        <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                                    </svg>
                                    Copy to Clipboard
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="dashboard-footer">
            <span>Want real-time notifications on your desktop? Try the new <a href="https://github.com/ready-to-review/pr-menubar" target="_blank" rel="noopener" style="color: #0969da; text-decoration: underline; font-weight: 500;">Ready to Review.app</a> <span style="background: #f3f4f6; color: #475569; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 500; vertical-align: middle;">(beta)</span></span>
        </footer>
    </div>

    <script src="/assets/demo-data.js"></script>
    <script src="/assets/app.js"></script>
</body>
</html>